<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Classification – Machine Learning Clearly Explained</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-b12f67c1ef80f99d4181da54e6f09d60.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Machine Learning Clearly Explained</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Introduction</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./regression.html"> 
<span class="menu-text">Regression</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./classification.html" aria-current="page"> 
<span class="menu-text">Classification</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./clustering.html"> 
<span class="menu-text">Clustering</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#step-1-install-and-load-the-required-package" id="toc-step-1-install-and-load-the-required-package" class="nav-link active" data-scroll-target="#step-1-install-and-load-the-required-package">📦 Step 1: Install and load the required package</a></li>
  <li><a href="#step-2-prepare-the-data" id="toc-step-2-prepare-the-data" class="nav-link" data-scroll-target="#step-2-prepare-the-data">🌸 Step 2: Prepare the data</a></li>
  <li><a href="#step-3-train-the-naive-bayes-model" id="toc-step-3-train-the-naive-bayes-model" class="nav-link" data-scroll-target="#step-3-train-the-naive-bayes-model">🧠 Step 3: Train the Naive Bayes model</a></li>
  <li><a href="#step-4-make-predictions" id="toc-step-4-make-predictions" class="nav-link" data-scroll-target="#step-4-make-predictions">🧪 Step 4: Make predictions</a></li>
  <li><a href="#step-5-evaluate-the-model" id="toc-step-5-evaluate-the-model" class="nav-link" data-scroll-target="#step-5-evaluate-the-model">📊 Step 5: Evaluate the model</a></li>
  <li><a href="#step-1-install-and-load-the-required-package-1" id="toc-step-1-install-and-load-the-required-package-1" class="nav-link" data-scroll-target="#step-1-install-and-load-the-required-package-1">📦 Step 1: Install and load the required package</a></li>
  <li><a href="#step-by-step-random-forest-example-in-r" id="toc-step-by-step-random-forest-example-in-r" class="nav-link" data-scroll-target="#step-by-step-random-forest-example-in-r">✅ <strong>Step-by-step Random Forest Example in R</strong></a></li>
  <li><a href="#prerequisites" id="toc-prerequisites" class="nav-link" data-scroll-target="#prerequisites">🔧 Prerequisites</a></li>
  <li><a href="#prepare-the-data" id="toc-prepare-the-data" class="nav-link" data-scroll-target="#prepare-the-data">📊 Prepare the Data</a></li>
  <li><a href="#train-the-neural-network" id="toc-train-the-neural-network" class="nav-link" data-scroll-target="#train-the-neural-network">🧠 Train the Neural Network</a></li>
  <li><a href="#make-predictions" id="toc-make-predictions" class="nav-link" data-scroll-target="#make-predictions">🔍 Make Predictions</a></li>
  <li><a href="#step-by-step-example-in-r" id="toc-step-by-step-example-in-r" class="nav-link" data-scroll-target="#step-by-step-example-in-r">Step-by-step Example in R:</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Classification</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Classification models are used when you know the categories, or labels, that you wish to use on your data. Both classification and regression are forms of <strong>supervised</strong> learning.</p>
<p>Supervised learning is a type of machine learning where the model learns from a labeled data set—that is, data that has both <strong>input features (X)</strong> and known <strong>target outputs (Y)</strong>.</p>
<p>The machine learns to map inputs to outputs so it can make predictions on new, unseen data.</p>
<p>A practical example of supervised learning and classification is spam email detection. We want to automatically classify incoming emails as <strong>“spam”</strong> or <strong>“not spam.”</strong> The <strong>inputs (features) c</strong>ould include:</p>
<ul>
<li><p>Presence of certain keywords (like “free”, “winner”, etc.)</p></li>
<li><p>Sender’s email address</p></li>
<li><p>Number of links or attachments</p></li>
<li><p>Email length</p></li>
<li><p>Frequency of punctuation like “!!!” or “$$$”</p></li>
<li><p>Use of ALL CAPS</p></li>
</ul>
<p>These act like clues to let the computer know that a specific email could be spam. You can understand how this is modeled on human thinking. We also look for patterns that will lead us to a conclusion.</p>
<p>The <strong>outputs (labels)</strong> in this case would be <code>1</code> for spam, and <code>0</code> for not spam (aka ham). If you have email a classification model is likely at work on your account, separating the “spam” from the “ham.”</p>
<p>Common supervised learning models used for classifying data are:</p>
<p><strong>Logistic Regression</strong></p>
<p>This is a statistical method used to model the relationship between a binary dependent variable and one or more independent variables. An answer is either “yes” or “no.” It estimates the probability that the dependent variable equals a certain value (usually 1), using a logistic function (a sigmoid, or s-shaped, curve).</p>
<p>To run a logistic regression in R, use the <code>glm()</code> function with an argument of <code>family = binomial</code>. This fits a generalized linear model where the dependent variable is binary (0/1). You should check assumptions, multicollinearity, and goodness-of-fit afterward.</p>
<p><strong>Naive Bayes (N-B)</strong></p>
<p>N-B is a probabilistic machine learning algorithm based on Bayes’ Theorem. It’s particularly used for classification tasks, and it’s called “naive” because it assumes independence between features — which is rarely true in practice, but surprisingly effective in many cases.</p>
<p>For example, in spam detection, N-B would assume that the presence of the word “free” is independent of “money” — given the email is spam. This is not usually true, but this simplifies the math <strong>a lot</strong>.</p>
<p>Here’s a simple example of implementing <strong>Naive Bayes</strong> in <strong>R</strong> using the built-in <code>iris</code> dataset and the <code>e1071</code> package.</p>
<hr>
<section id="step-1-install-and-load-the-required-package" class="level3">
<h3 class="anchored" data-anchor-id="step-1-install-and-load-the-required-package">📦 Step 1: Install and load the required package</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"e1071"</span>)  <span class="co"># Only run this once</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="step-2-prepare-the-data" class="level3">
<h3 class="anchored" data-anchor-id="step-2-prepare-the-data">🌸 Step 2: Prepare the data</h3>
<p>We’ll use the famous <code>iris</code> dataset, which classifies flowers into three species.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's split the data into training and test sets</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>indexes <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(iris), <span class="fl">0.7</span> <span class="sc">*</span> <span class="fu">nrow</span>(iris))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> iris[indexes, ]</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> iris[<span class="sc">-</span>indexes, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="step-3-train-the-naive-bayes-model" class="level3">
<h3 class="anchored" data-anchor-id="step-3-train-the-naive-bayes-model">🧠 Step 3: Train the Naive Bayes model</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">naiveBayes</span>(Species <span class="sc">~</span> ., <span class="at">data =</span> train_data)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="step-4-make-predictions" class="level3">
<h3 class="anchored" data-anchor-id="step-4-make-predictions">🧪 Step 4: Make predictions</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, test_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="step-5-evaluate-the-model" class="level3">
<h3 class="anchored" data-anchor-id="step-5-evaluate-the-model">📊 Step 5: Evaluate the model</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>{r}</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: true</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">Predicted =</span> predictions, <span class="at">Actual =</span> test_data<span class="sc">$</span>Species)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(confusion_matrix)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(confusion_matrix)) <span class="sc">/</span> <span class="fu">sum</span>(confusion_matrix)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Accuracy:"</span>, <span class="fu">round</span>(accuracy <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
<p>A confusion matrix is a table that visualizes the performance of a classification model by comparing its predicted labels to the true labels. It’s a valuable tool for understanding where a model might be getting confused and identifying areas for improvement.</p>
<p>You can explore Naive Bayes further with different data sets, feature selection, and using the <code>caret</code> or <code>mlr3</code> packages in R for more structured workflows.</p>
<p><strong>Support Vector Machines</strong></p>
<p>SVM is a supervised machine learning algorithm primarily used for classification, but it can also handle regression tasks. This means that</p>
<p>At its core, an SVM tries to find the best boundary (hyperplane) that separates data points of different classes in the feature space. SVM tries to <strong>maximize the margin</strong> between data points of different classes. The margin is the distance between the hyperplane and the <strong>nearest points from each class</strong>, which are called <strong>support vectors</strong>.</p>
<p>A SVM for R might look like this:</p>
<hr>
</section>
<section id="step-1-install-and-load-the-required-package-1" class="level3">
<h3 class="anchored" data-anchor-id="step-1-install-and-load-the-required-package-1">📦 Step 1: Install and load the required package</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install if not already installed</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"e1071"</span>) <span class="co"># Only run this once</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Downloading packages -------------------------------------------------------
- Downloading e1071 from CRAN ...               OK [571.2 Kb in 0.16s]
- Downloading proxy from CRAN ...               OK [169.3 Kb in 0.4s]
Successfully downloaded 2 packages in 0.87 seconds.

The following package(s) will be installed:
- e1071 [1.7-16]
- proxy [0.4-27]
These packages will be installed into "~/work/Machine-Learning-Clearly-Explained/Machine-Learning-Clearly-Explained/renv/library/R-4.2/x86_64-pc-linux-gnu".

# Installing packages --------------------------------------------------------
- Installing proxy ...                          OK [installed binary and cached in 0.2s]
- Installing e1071 ...                          OK [installed binary and cached in 0.22s]
Successfully installed 2 packages in 0.47 seconds.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the package</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You might notice that the <code>e1071</code> package is handy. You can use it for both N-B and SVM, and thus easily build and compare the two types of models.</p>
<p><strong>Random Forests</strong></p>
<p>These are essentially a collection of decision trees—hence the name “forest.” Each tree is trained on a slightly different subset of the data, and their outputs are aggregated to make the final prediction.</p>
<p>For classification, the forest outputs the class that has the majority vote among the trees.</p>
<p>For regression, it averages the predictions of all the trees.</p>
<p>But what about it is “random?”</p>
<ol type="1">
<li><p><strong>Bootstrap sampling (Bagging)</strong>: Each tree is trained on a <strong>random sample</strong> (with replacement) of the training data.</p></li>
<li><p><strong>Random feature selection</strong>: When splitting nodes, each tree considers only a <strong>random subset of features</strong> instead of all features. This adds diversity and reduces correlation among trees.</p></li>
</ol>
<p>Here’s an example of using Random Forest in R using the built-in <code>iris</code> dataset. We’ll use the <code>randomForest</code> package, a popular and simple way to build Random Forest models.</p>
</section>
<section id="step-by-step-random-forest-example-in-r" class="level3">
<h3 class="anchored" data-anchor-id="step-by-step-random-forest-example-in-r">✅ <strong>Step-by-step Random Forest Example in R</strong></h3>
<section id="install-and-load-the-package" class="level4">
<h4 class="anchored" data-anchor-id="install-and-load-the-package">1. <strong>Install and load the package</strong></h4>
<pre><code>install.packages("randomForest")  # Only run once library(randomForest) </code></pre>
</section>
<section id="load-the-data" class="level4">
<h4 class="anchored" data-anchor-id="load-the-data">2. <strong>Load the data</strong></h4>
<pre><code>data(iris) head(iris) </code></pre>
</section>
<section id="split-the-data-into-training-and-test-sets" class="level4">
<h4 class="anchored" data-anchor-id="split-the-data-into-training-and-test-sets">3. <strong>Split the data into training and test sets</strong></h4>
<pre><code>set.seed(123)  # For reproducibility sample_index &lt;- sample(1:nrow(iris), 0.7 * nrow(iris))  # 70% train train_data &lt;- iris[sample_index, ] test_data &lt;- iris[-sample_index, ] </code></pre>
</section>
<section id="train-the-random-forest-model" class="level4">
<h4 class="anchored" data-anchor-id="train-the-random-forest-model">4. <strong>Train the Random Forest model</strong></h4>
<pre><code>model &lt;- randomForest(Species ~ ., data = train_data, ntree = 100, mtry = 2, importance = TRUE) print(model) </code></pre>
</section>
<section id="predict-on-test-data" class="level4">
<h4 class="anchored" data-anchor-id="predict-on-test-data">5. <strong>Predict on test data</strong></h4>
<pre><code>predictions &lt;- predict(model, newdata = test_data) </code></pre>
</section>
<section id="evaluate-model-accuracy" class="level4">
<h4 class="anchored" data-anchor-id="evaluate-model-accuracy">6. <strong>Evaluate model accuracy</strong></h4>
<pre><code>confusion_matrix &lt;- table(predicted = predictions, actual = test_data$Species) print(confusion_matrix) accuracy &lt;- sum(diag(confusion_matrix)) / sum(confusion_matrix) cat("Accuracy:", accuracy) </code></pre>
</section>
<section id="plot-feature-importance" class="level4">
<h4 class="anchored" data-anchor-id="plot-feature-importance">7. <strong>Plot feature importance</strong></h4>
<pre><code>importance(model) varImpPlot(model) </code></pre>
<p><strong>Neural Networks</strong></p>
<p>A Neural Networks (NN) machine learning model inspired by how the human brain works. It is composed of layers of interconnected nodes (called <strong>neurons</strong>) that can learn to recognize patterns in data.</p>
<p>In essence, a neural network is a <strong>function approximator</strong> that maps input data to an output (like predicting if a person has diabetes or classifying an image).</p>
<p>Here’s a <strong>brief example</strong> of a neural network built in <strong>R</strong> using the <code>neuralnet</code> package to predict the logical <strong>AND</strong> function.</p>
</section>
</section>
<section id="prerequisites" class="level3">
<h3 class="anchored" data-anchor-id="prerequisites">🔧 Prerequisites</h3>
<p>First, install and load the <code>neuralnet</code> package:</p>
<pre><code>install.packages("neuralnet") library(neuralnet) </code></pre>
</section>
<section id="prepare-the-data" class="level3">
<h3 class="anchored" data-anchor-id="prepare-the-data">📊 Prepare the Data</h3>
<p>Create a simple dataset for the AND function:</p>
<pre><code># Create data frame training_data &lt;- data.frame(   input1 = c(0, 0, 1, 1),   input2 = c(0, 1, 0, 1),   output = c(0, 0, 0, 1) ) </code></pre>
</section>
<section id="train-the-neural-network" class="level3">
<h3 class="anchored" data-anchor-id="train-the-neural-network">🧠 Train the Neural Network</h3>
<pre><code># Train neural network model &lt;- neuralnet(output ~ input1 + input2,                     data = training_data,                     hidden = 2,      # One hidden layer with 2 neurons                    linear.output = FALSE)  # Plot the network plot(model) </code></pre>
</section>
<section id="make-predictions" class="level3">
<h3 class="anchored" data-anchor-id="make-predictions">🔍 Make Predictions</h3>
<pre><code># Test the network predictions &lt;- compute(model, training_data[, c("input1", "input2")]) predictions$net.result  # Output probabilities </code></pre>
<p>This is a basic example. For more complex datasets, consider using <code>keras</code> in R for deep learning. <strong>Deep learning</strong> is a subset of machine learning that uses neural networks with many layers (hence “deep”) to model complex patterns in data. It excels at learning from large volumes of unstructured data such as images, audio, text, and video.</p>
<p>Here’s a simple example of a deep learning model in R using the <code>keras</code> package. This example uses the classic <strong>MNIST handwritten digit classification</strong> problem.</p>
</section>
<section id="step-by-step-example-in-r" class="level3">
<h3 class="anchored" data-anchor-id="step-by-step-example-in-r">Step-by-step Example in R:</h3>
<section id="install-and-load-the-necessary-packages" class="level4">
<h4 class="anchored" data-anchor-id="install-and-load-the-necessary-packages">1. <strong>Install and load the necessary packages</strong></h4>
<pre><code>install.packages("keras") library(keras) </code></pre>
</section>
<section id="load-the-mnist-dataset" class="level4">
<h4 class="anchored" data-anchor-id="load-the-mnist-dataset">2. <strong>Load the MNIST dataset</strong></h4>
<pre><code>mnist &lt;- dataset_mnist() x_train &lt;- mnist$train$x y_train &lt;- mnist$train$y x_test &lt;- mnist$test$x y_test &lt;- mnist$test$y </code></pre>
</section>
<section id="preprocess-the-data" class="level4">
<h4 class="anchored" data-anchor-id="preprocess-the-data">3. <strong>Preprocess the data</strong></h4>
<pre><code># Reshape and normalize input data x_train &lt;- array_reshape(x_train, c(nrow(x_train), 784)) / 255 x_test &lt;- array_reshape(x_test, c(nrow(x_test), 784)) / 255  # One-hot encode the labels y_train &lt;- to_categorical(y_train, 10) y_test &lt;- to_categorical(y_test, 10) </code></pre>
</section>
<section id="define-the-deep-learning-model" class="level4">
<h4 class="anchored" data-anchor-id="define-the-deep-learning-model">4. <strong>Define the deep learning model</strong></h4>
<pre><code>model &lt;- keras_model_sequential() %&gt;%   layer_dense(units = 256, activation = 'relu', input_shape = c(784)) %&gt;%   layer_dropout(rate = 0.4) %&gt;%   layer_dense(units = 128, activation = 'relu') %&gt;%   layer_dropout(rate = 0.3) %&gt;%   layer_dense(units = 10, activation = 'softmax') </code></pre>
</section>
<section id="compile-the-model" class="level4">
<h4 class="anchored" data-anchor-id="compile-the-model">5. <strong>Compile the model</strong></h4>
<pre><code>model %&gt;% compile(   loss = 'categorical_crossentropy',   optimizer = optimizer_adam(),   metrics = c('accuracy') ) </code></pre>
</section>
<section id="train-the-model" class="level4">
<h4 class="anchored" data-anchor-id="train-the-model">6. <strong>Train the model</strong></h4>
<pre><code>history &lt;- model %&gt;% fit(   x_train, y_train,   epochs = 30,   batch_size = 128,   validation_split = 0.2 ) </code></pre>
</section>
<section id="evaluate-the-model" class="level4">
<h4 class="anchored" data-anchor-id="evaluate-the-model">7. <strong>Evaluate the model</strong></h4>
<pre><code>score &lt;- model %&gt;% evaluate(x_test, y_test) cat('Test loss:', score$loss, '\n') cat('Test accuracy:', score$accuracy, '\n') </code></pre>
<p>This will train a neural network with two hidden layers on the MNIST dataset.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/DSD-resilience\.github\.io\/Machine-Learning-Clearly-Explained\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>